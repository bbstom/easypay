# ç”Ÿäº§ç¯å¢ƒæ ·å¼ä¿®å¤ - å¿«é€ŸæŒ‡å—

## é—®é¢˜

âœ… å¼€å‘ç¯å¢ƒæ ·å¼æ­£å¸¸  
âŒ ç”Ÿäº§ç¯å¢ƒæ ·å¼ä¸ç”Ÿæ•ˆ

---

## å¿«é€Ÿä¿®å¤ï¼ˆ3 åˆ†é’Ÿï¼‰

### æ–¹æ³• 1ï¼šä½¿ç”¨ä¿®å¤è„šæœ¬ï¼ˆæ¨èï¼‰

**Linux/Mac æœåŠ¡å™¨**ï¼š
```bash
# ä¸Šä¼  fix-production-styles.sh åˆ°æœåŠ¡å™¨
# ç„¶åæ‰§è¡Œï¼š
cd /www/wwwroot/kk.vpno.eu.org/easypay
bash fix-production-styles.sh
```

**Windows æœåŠ¡å™¨**ï¼š
```cmd
cd E:\vscodefile\easypay
fix-production-styles.bat
```

### æ–¹æ³• 2ï¼šæ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /www/wwwroot/kk.vpno.eu.org/easypay

# 2. æ¸…é™¤æ„å»ºç¼“å­˜
rm -rf dist node_modules/.vite

# 3. é‡æ–°æ„å»º
npm run build

# 4. é‡å¯æœåŠ¡
pm2 restart all

# 5. æŸ¥çœ‹æ—¥å¿—
pm2 logs --lines 20
```

### æ–¹æ³• 3ï¼šå®Œå…¨é‡å»ºï¼ˆå¦‚æœä¸Šé¢ä¸è¡Œï¼‰

```bash
# 1. é‡æ–°å®‰è£…ä¾èµ–
rm -rf node_modules
npm install

# 2. éªŒè¯æ’ä»¶
npm list @tailwindcss/typography

# 3. æ¸…é™¤ç¼“å­˜
rm -rf dist node_modules/.vite

# 4. é‡æ–°æ„å»º
npm run build

# 5. é‡å¯æœåŠ¡
pm2 restart all
```

---

## éªŒè¯ä¿®å¤

### 1. æ£€æŸ¥æ„å»ºäº§ç‰©

```bash
# æŸ¥çœ‹ CSS æ–‡ä»¶
ls -lh dist/assets/*.css

# æ£€æŸ¥æ˜¯å¦åŒ…å« prose æ ·å¼
grep -o "\.prose" dist/assets/*.css | head -5
```

åº”è¯¥çœ‹åˆ°ï¼š
```
.prose
.prose-lg
.prose-slate
.prose-h2\:text-3xl
.prose-h3\:text-2xl
```

### 2. æµè§ˆå™¨éªŒè¯

1. **æ¸…é™¤ç¼“å­˜**ï¼š`Ctrl + Shift + Delete`
2. **ç¡¬åˆ·æ–°**ï¼š`Ctrl + Shift + R`
3. **è®¿é—®**ï¼š`https://kk.vpno.eu.org/blog/usdt-ä»£ä»˜å®Œå…¨æŒ‡å—-ä»å…¥é—¨åˆ°ç²¾é€š`

### 3. æ£€æŸ¥æ ·å¼

æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ï¼Œåœ¨ Console ä¸­æ‰§è¡Œï¼š

```javascript
// æ£€æŸ¥ prose ç±»æ˜¯å¦å­˜åœ¨
document.querySelector('.prose')

// æ£€æŸ¥ H2 æ ·å¼
const h2 = document.querySelector('.prose h2');
console.log(window.getComputedStyle(h2).fontSize); // åº”è¯¥æ˜¯ "30px"
console.log(window.getComputedStyle(h2).borderBottom); // åº”è¯¥æœ‰è¾¹æ¡†
```

---

## æ’æŸ¥æ¸…å•

å¦‚æœè¿˜æ˜¯ä¸è¡Œï¼ŒæŒ‰é¡ºåºæ£€æŸ¥ï¼š

### âœ… 1. æœåŠ¡å™¨æ–‡ä»¶æ˜¯å¦æœ€æ–°

```bash
# æ£€æŸ¥ tailwind.config.js
cat tailwind.config.js | grep typography

# åº”è¯¥çœ‹åˆ°ï¼š
# require('@tailwindcss/typography'),
```

### âœ… 2. ä¾èµ–æ˜¯å¦å®‰è£…

```bash
npm list @tailwindcss/typography

# åº”è¯¥æ˜¾ç¤ºï¼š
# â””â”€â”€ @tailwindcss/typography@0.5.19
```

### âœ… 3. æ„å»ºæ˜¯å¦æˆåŠŸ

```bash
# æŸ¥çœ‹æ„å»ºæ—¥å¿—
npm run build 2>&1 | tee build.log

# æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯
grep -i error build.log
```

### âœ… 4. CSS æ–‡ä»¶æ˜¯å¦åŒ…å«æ ·å¼

```bash
# æ£€æŸ¥ CSS æ–‡ä»¶å†…å®¹
cat dist/assets/*.css | grep "\.prose" | head -10
```

### âœ… 5. æœåŠ¡æ˜¯å¦é‡å¯

```bash
# æŸ¥çœ‹ PM2 çŠ¶æ€
pm2 list

# æŸ¥çœ‹é‡å¯æ—¶é—´ï¼ˆåº”è¯¥æ˜¯æœ€è¿‘ï¼‰
pm2 show easypay | grep "restarts"
```

### âœ… 6. æµè§ˆå™¨ç¼“å­˜æ˜¯å¦æ¸…é™¤

- ç¡¬åˆ·æ–°ï¼š`Ctrl + Shift + R`
- æˆ–è€…åœ¨ URL ååŠ æ—¶é—´æˆ³ï¼š`?t=123456`

---

## å¸¸è§é”™è¯¯

### é”™è¯¯ 1ï¼šCannot find module '@tailwindcss/typography'

**è§£å†³**ï¼š
```bash
npm install @tailwindcss/typography
npm run build
```

### é”™è¯¯ 2ï¼šæ„å»ºæˆåŠŸä½†æ ·å¼ä¸ç”Ÿæ•ˆ

**åŸå› **ï¼šæµè§ˆå™¨ç¼“å­˜

**è§£å†³**ï¼š
- æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
- ä½¿ç”¨éšç§æ¨¡å¼æµ‹è¯•
- æˆ–è€…åœ¨ URL ååŠ  `?v=2`

### é”™è¯¯ 3ï¼šCSS æ–‡ä»¶ä¸­æ²¡æœ‰ prose æ ·å¼

**åŸå› **ï¼šTailwind é…ç½®é—®é¢˜

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥é…ç½®
cat tailwind.config.js

# ç¡®ä¿åŒ…å«ï¼š
# plugins: [
#   require('@tailwindcss/typography'),
# ],
```

### é”™è¯¯ 4ï¼šPM2 é‡å¯åè¿˜æ˜¯æ—§ç‰ˆæœ¬

**è§£å†³**ï¼š
```bash
# å®Œå…¨åœæ­¢
pm2 delete all

# é‡æ–°å¯åŠ¨
pm2 start ecosystem.config.js

# ä¿å­˜é…ç½®
pm2 save
```

---

## è°ƒè¯•æŠ€å·§

### 1. å¯¹æ¯”å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒ

**å¼€å‘ç¯å¢ƒ**ï¼š
```bash
npm run dev
# è®¿é—® http://localhost:3000
```

**ç”Ÿäº§ç¯å¢ƒ**ï¼š
```bash
npm run build
cd dist
python3 -m http.server 8080
# è®¿é—® http://localhost:8080
```

å¦‚æœæœ¬åœ°ç”Ÿäº§æ„å»ºæ­£å¸¸ï¼Œè¯´æ˜æ˜¯æœåŠ¡å™¨é—®é¢˜ã€‚

### 2. æ£€æŸ¥ CSS æ–‡ä»¶å·®å¼‚

```bash
# å¼€å‘ç¯å¢ƒçš„ CSSï¼ˆä»æµè§ˆå™¨ä¿å­˜ï¼‰
# ç”Ÿäº§ç¯å¢ƒçš„ CSSï¼ˆä»æœåŠ¡å™¨ä¸‹è½½ï¼‰

# å¯¹æ¯”ä¸¤ä¸ªæ–‡ä»¶
diff dev.css prod.css
```

### 3. æŸ¥çœ‹ç½‘ç»œè¯·æ±‚

åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ Network æ ‡ç­¾ï¼š
- æ‰¾åˆ° CSS æ–‡ä»¶
- æŸ¥çœ‹ Response Headers
- ç¡®è®¤ `Cache-Control` å’Œ `ETag`
- ç¡®è®¤æ–‡ä»¶å¤§å°æ˜¯å¦æ­£ç¡®

---

## é¢„é˜²æªæ–½

### 1. æ·»åŠ åˆ°éƒ¨ç½²è„šæœ¬

åœ¨ `deploy.sh` ä¸­æ·»åŠ ï¼š

```bash
#!/bin/bash
echo "ğŸš€ å¼€å§‹éƒ¨ç½²..."

# æ¸…é™¤ç¼“å­˜
rm -rf dist node_modules/.vite

# æ„å»º
npm run build

# éªŒè¯æ„å»º
if ! grep -q "\.prose" dist/assets/*.css; then
  echo "âŒ æ„å»ºå¤±è´¥ï¼šCSS ä¸­æ²¡æœ‰ prose æ ·å¼"
  exit 1
fi

# é‡å¯æœåŠ¡
pm2 restart all

echo "âœ… éƒ¨ç½²å®Œæˆ"
```

### 2. è®¾ç½®æ„å»ºåé’©å­

åœ¨ `package.json` ä¸­ï¼š

```json
{
  "scripts": {
    "build": "vite build",
    "postbuild": "node scripts/verify-build.js"
  }
}
```

### 3. ä½¿ç”¨ç‰ˆæœ¬å·

åœ¨é¡µé¢åº•éƒ¨æ˜¾ç¤ºæ„å»ºæ—¶é—´ï¼š

```jsx
<footer>
  <p>æ„å»ºæ—¶é—´: {import.meta.env.BUILD_TIME}</p>
</footer>
```

---

## ä¸€é”®ä¿®å¤å‘½ä»¤

å¤åˆ¶ç²˜è´´åˆ°æœåŠ¡å™¨ç»ˆç«¯ï¼š

```bash
cd /www/wwwroot/kk.vpno.eu.org/easypay && \
rm -rf dist node_modules/.vite && \
npm run build && \
pm2 restart all && \
echo "âœ… ä¿®å¤å®Œæˆï¼Œè¯·åœ¨æµè§ˆå™¨ä¸­ç¡¬åˆ·æ–°ï¼ˆCtrl+Shift+Rï¼‰"
```

---

## éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœä»¥ä¸Šæ–¹æ³•éƒ½ä¸è¡Œï¼Œæä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **æ„å»ºæ—¥å¿—**ï¼š
   ```bash
   npm run build 2>&1 | tee build.log
   ```

2. **CSS æ–‡ä»¶å†…å®¹**ï¼š
   ```bash
   head -100 dist/assets/*.css
   ```

3. **ä¾èµ–åˆ—è¡¨**ï¼š
   ```bash
   npm list @tailwindcss/typography
   ```

4. **Tailwind é…ç½®**ï¼š
   ```bash
   cat tailwind.config.js
   ```

5. **æµè§ˆå™¨æ§åˆ¶å°æˆªå›¾**ï¼ˆF12 â†’ Consoleï¼‰

---

## æ€»ç»“

**æœ€å¸¸è§çš„åŸå› **ï¼š
1. æ„å»ºç¼“å­˜æ²¡æ¸…é™¤
2. æµè§ˆå™¨ç¼“å­˜æ²¡æ¸…é™¤
3. æœåŠ¡æ²¡é‡å¯

**æœ€å¿«çš„è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
rm -rf dist node_modules/.vite && npm run build && pm2 restart all
```

ç„¶ååœ¨æµè§ˆå™¨ä¸­ `Ctrl + Shift + R` ç¡¬åˆ·æ–°ã€‚
