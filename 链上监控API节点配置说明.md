# é“¾ä¸Šç›‘æ§ API èŠ‚ç‚¹é…ç½®è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°

ç³»ç»Ÿæ”¯æŒé…ç½®å¤šä¸ª TRON API èŠ‚ç‚¹ï¼Œå®ç°ï¼š
- å¤šèŠ‚ç‚¹å†—ä½™å¤‡ä»½
- è‡ªåŠ¨æ•…éšœåˆ‡æ¢
- è´Ÿè½½å‡è¡¡
- æé«˜ç³»ç»Ÿå¯ç”¨æ€§

## æ”¯æŒçš„èŠ‚ç‚¹æœåŠ¡å•†

### 1. TronGridï¼ˆå®˜æ–¹æ¨èï¼‰
- **å®˜ç½‘**: https://www.trongrid.io/
- **API URL**: `https://api.trongrid.io`
- **ç‰¹ç‚¹**: 
  - å®˜æ–¹èŠ‚ç‚¹ï¼Œç¨³å®šå¯é 
  - å…è´¹é¢åº¦ï¼šæ¯ç§’ 5 æ¬¡è¯·æ±‚
  - æ³¨å†Œåå¯è·å¾— API Keyï¼Œæå‡è‡³æ¯ç§’ 100 æ¬¡
- **è·å– API Key**: 
  1. è®¿é—® https://www.trongrid.io/
  2. æ³¨å†Œè´¦å·
  3. åˆ›å»º API Keyï¼ˆå…è´¹ï¼‰

### 2. ZANï¼ˆä¼ä¸šçº§æ¨èï¼‰
- **å®˜ç½‘**: https://zan.top/cn
- **API URL**: `https://api.zan.top/node/v1/tron/mainnet/{your_api_key}`
- **ç‰¹ç‚¹**:
  - ä¼ä¸šçº§èŠ‚ç‚¹æœåŠ¡
  - é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿ
  - æ”¯æŒå¤šç§åŒºå—é“¾
- **è·å– API Key**:
  1. è®¿é—® https://zan.top/cn
  2. æ³¨å†Œè´¦å·
  3. åˆ›å»º TRON èŠ‚ç‚¹ API Key
  4. å°† API Key ç›´æ¥å¡«å…¥ URL ä¸­çš„ `{your_api_key}` ä½ç½®ï¼ˆä¸è¦ä¿ç•™èŠ±æ‹¬å·ï¼‰

## é…ç½®æ­¥éª¤

### 1. è¿›å…¥é…ç½®é¡µé¢

ç®¡ç†å‘˜åå° â†’ é’±åŒ…é…ç½® â†’ åŸºç¡€é…ç½® â†’ é“¾ä¸Šç›‘æ§ API èŠ‚ç‚¹é…ç½®

### 2. é…ç½®èŠ‚ç‚¹

æ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä»¥ä¸‹é…ç½®é¡¹ï¼š

#### TronGrid èŠ‚ç‚¹
```
åç§°: TronGrid
API URL: https://api.trongrid.io
API Key: [ä» TronGrid å®˜ç½‘è·å–]
çŠ¶æ€: å¯ç”¨ âœ“
```

#### ZAN èŠ‚ç‚¹
```
åç§°: ZAN
API URL: https://api.zan.top/node/v1/tron/mainnet/YOUR_API_KEY
API Key: [å¯é€‰ï¼Œå·²åŒ…å«åœ¨ URL ä¸­]
çŠ¶æ€: å¯ç”¨ âœ“
```

**é‡è¦**: ZAN çš„ API Key ç›´æ¥æ”¾åœ¨ URL ä¸­ï¼Œä¸è¦ä¿ç•™èŠ±æ‹¬å· `{}`ã€‚

### 3. ä¿å­˜é…ç½®

ç‚¹å‡»"ä¿å­˜é…ç½®"æŒ‰é’®ï¼Œç³»ç»Ÿä¼šï¼š
1. éªŒè¯é…ç½®æ ¼å¼
2. ä¿å­˜åˆ°æ•°æ®åº“
3. é‡æ–°åˆå§‹åŒ– TronWeb
4. æµ‹è¯•èŠ‚ç‚¹è¿æ¥

## èŠ‚ç‚¹åˆ‡æ¢æœºåˆ¶

### è‡ªåŠ¨åˆ‡æ¢

ç³»ç»Ÿä¼šæŒ‰ä»¥ä¸‹é¡ºåºå°è¯•è¿æ¥èŠ‚ç‚¹ï¼š

1. **ç¬¬ä¸€ä¼˜å…ˆçº§**: é…ç½®çš„ç¬¬ä¸€ä¸ªå¯ç”¨èŠ‚ç‚¹ï¼ˆé€šå¸¸æ˜¯ TronGridï¼‰
2. **ç¬¬äºŒä¼˜å…ˆçº§**: é…ç½®çš„ç¬¬äºŒä¸ªå¯ç”¨èŠ‚ç‚¹ï¼ˆZANï¼‰
3. **å¤±è´¥å¤„ç†**: å¦‚æœæ‰€æœ‰é…ç½®çš„èŠ‚ç‚¹éƒ½å¤±è´¥ï¼Œç³»ç»Ÿä¼šæŠ›å‡ºé”™è¯¯

**é‡è¦**: ç³»ç»Ÿä¸å†ä½¿ç”¨å†…ç½®å¤‡ç”¨èŠ‚ç‚¹ï¼Œåªä½¿ç”¨æ‚¨é…ç½®çš„èŠ‚ç‚¹ã€‚è¯·ç¡®ä¿è‡³å°‘é…ç½®ä¸€ä¸ªå¯ç”¨çš„èŠ‚ç‚¹ã€‚

### åˆ‡æ¢æ¡ä»¶

èŠ‚ç‚¹åˆ‡æ¢å‘ç”Ÿåœ¨ä»¥ä¸‹æƒ…å†µï¼š
- å½“å‰èŠ‚ç‚¹è¿æ¥å¤±è´¥
- API è¯·æ±‚è¶…æ—¶ï¼ˆ30ç§’ï¼‰
- è¿”å› 429 é™æµé”™è¯¯
- è¿”å› 5xx æœåŠ¡å™¨é”™è¯¯

### åˆ‡æ¢æµç¨‹

```
åˆå§‹åŒ– â†’ å°è¯•èŠ‚ç‚¹1 â†’ å¤±è´¥ â†’ å°è¯•èŠ‚ç‚¹2 â†’ å¤±è´¥ â†’ æŠ›å‡ºé”™è¯¯
```

## é…ç½®ç¤ºä¾‹

### åœºæ™¯ 1: å•èŠ‚ç‚¹ï¼ˆåŸºç¡€é…ç½®ï¼‰

åªå¯ç”¨ TronGridï¼š
```json
[
  {
    "name": "TronGrid",
    "url": "https://api.trongrid.io",
    "apiKey": "your_api_key_here",
    "enabled": true
  },
  {
    "name": "ZAN",
    "url": "",
    "apiKey": "",
    "enabled": false
  },
  {
    "name": "TronScan",
    "url": "",
    "apiKey": "",
    "enabled": false
  }
]
```

### åœºæ™¯ 2: åŒèŠ‚ç‚¹ï¼ˆé«˜å¯ç”¨é…ç½® - æ¨èï¼‰

å¯ç”¨ TronGrid + ZANï¼š
```json
[
  {
    "name": "TronGrid",
    "url": "https://api.trongrid.io",
    "apiKey": "trongrid_api_key",
    "enabled": true
  },
  {
    "name": "ZAN",
    "url": "https://api.zan.top/node/v1/tron/mainnet/zan_api_key",
    "apiKey": "",
    "enabled": true
  }
]
```

**é‡è¦**: ZAN çš„ API Key è¦ç›´æ¥æ›¿æ¢ URL ä¸­çš„ `zan_api_key`ï¼Œä¸è¦ä¿ç•™èŠ±æ‹¬å·ã€‚

## ç›‘æ§å’Œè¯Šæ–­

### æŸ¥çœ‹å½“å‰èŠ‚ç‚¹

åœ¨"çŠ¶æ€ç›‘æ§"æ ‡ç­¾ä¸­å¯ä»¥çœ‹åˆ°ï¼š
- å½“å‰ä½¿ç”¨çš„èŠ‚ç‚¹åç§°
- èŠ‚ç‚¹ URL
- è¿æ¥çŠ¶æ€
- æ˜¯å¦ä¸ºå¤‡ç”¨èŠ‚ç‚¹

### æ—¥å¿—è¾“å‡º

ç³»ç»Ÿä¼šåœ¨æ§åˆ¶å°è¾“å‡ºè¯¦ç»†æ—¥å¿—ï¼š

```
ğŸ”— å·²åŠ è½½ 2 ä¸ª API èŠ‚ç‚¹
   1. TronGrid: https://api.trongrid.io (æœ‰ API Key)
   2. ZAN: https://api.zan.top/node/v1/tron/mainnet/xxx (æœ‰ API Key)
ğŸ”— å°è¯•è¿æ¥èŠ‚ç‚¹ 1/2: TronGrid (https://api.trongrid.io)
âœ… ä½¿ç”¨ API Key: trongrid_a...
âœ… èŠ‚ç‚¹è¿æ¥æˆåŠŸ: TronGrid
âœ… TronWeb åˆå§‹åŒ–æˆåŠŸ
ğŸ“ å½“å‰èŠ‚ç‚¹: https://api.trongrid.io
```

### æ•…éšœåˆ‡æ¢æ—¥å¿—

```
âŒ èŠ‚ç‚¹è¿æ¥å¤±è´¥ (TronGrid): API è¯·æ±‚è¶…æ—¶
ğŸ”— å°è¯•è¿æ¥èŠ‚ç‚¹ 2/2: ZAN (https://api.zan.top/...)
âœ… èŠ‚ç‚¹è¿æ¥æˆåŠŸ: ZAN
```

## æœ€ä½³å®è·µ

### 1. é…ç½®å»ºè®®

- **ç”Ÿäº§ç¯å¢ƒ**: é…ç½® 2 ä¸ªèŠ‚ç‚¹ï¼ˆTronGrid + ZANï¼‰
- **æµ‹è¯•ç¯å¢ƒ**: å¯ä»¥åªé…ç½® 1 ä¸ªèŠ‚ç‚¹

### 2. API Key ç®¡ç†

- ä¸ºæ¯ä¸ªèŠ‚ç‚¹ç”³è¯·ç‹¬ç«‹çš„ API Key
- å®šæœŸæ£€æŸ¥ API Key ä½¿ç”¨æƒ…å†µ
- é¿å…åœ¨å¤šä¸ªç³»ç»Ÿå…±äº«åŒä¸€ä¸ª API Key

### 3. æ€§èƒ½ä¼˜åŒ–

- ä¼˜å…ˆä½¿ç”¨æœ‰ API Key çš„èŠ‚ç‚¹
- å°†å“åº”é€Ÿåº¦å¿«çš„èŠ‚ç‚¹æ”¾åœ¨å‰é¢
- å®šæœŸæµ‹è¯•èŠ‚ç‚¹å¯ç”¨æ€§

### 4. å®‰å…¨å»ºè®®

- ä¸è¦åœ¨å‰ç«¯æš´éœ² API Key
- ä½¿ç”¨ HTTPS åè®®
- å®šæœŸæ›´æ¢ API Key

## æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: æ‰€æœ‰èŠ‚ç‚¹éƒ½è¿æ¥å¤±è´¥

**å¯èƒ½åŸå› **:
- ç½‘ç»œé—®é¢˜
- API Key æ— æ•ˆ
- URL é…ç½®é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. éªŒè¯ API Key æ˜¯å¦æœ‰æ•ˆ
3. ç¡®è®¤ URL æ ¼å¼æ­£ç¡®
4. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—

### é—®é¢˜ 2: é¢‘ç¹åˆ‡æ¢èŠ‚ç‚¹

**å¯èƒ½åŸå› **:
- èŠ‚ç‚¹ä¸ç¨³å®š
- è¯·æ±‚é¢‘ç‡è¿‡é«˜
- API Key é¢åº¦ä¸è¶³

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥èŠ‚ç‚¹çŠ¶æ€
2. ç”³è¯·æ›´é«˜é¢åº¦çš„ API Key
3. ä¼˜åŒ–è¯·æ±‚é¢‘ç‡
4. ä½¿ç”¨æ›´ç¨³å®šçš„èŠ‚ç‚¹

### é—®é¢˜ 3: 429 é™æµé”™è¯¯

**å¯èƒ½åŸå› **:
- æœªé…ç½® API Key
- API Key é¢åº¦ç”¨å®Œ
- è¯·æ±‚é¢‘ç‡è¶…é™

**è§£å†³æ–¹æ¡ˆ**:
1. é…ç½® API Key
2. å‡çº§ API Key å¥—é¤
3. å¯ç”¨å¤šä¸ªèŠ‚ç‚¹åˆ†æ•£è¯·æ±‚
4. ä¼˜åŒ–æŸ¥è¯¢é€»è¾‘

## æŠ€æœ¯å®ç°

### æ•°æ®åº“å­˜å‚¨

```javascript
tronApiNodes: {
  type: String,
  default: JSON.stringify([
    { name: 'TronGrid', url: 'https://api.trongrid.io', apiKey: '', enabled: true },
    { name: 'ZAN', url: '', apiKey: '', enabled: false },
    { name: 'TronScan', url: '', apiKey: '', enabled: false }
  ])
}
```

### èŠ‚ç‚¹åŠ è½½

```javascript
// ä»æ•°æ®åº“åŠ è½½èŠ‚ç‚¹é…ç½®
const nodes = JSON.parse(settings.tronApiNodes);
this.apiNodes = nodes.filter(node => node.enabled && node.url);
```

### è¿æ¥é€»è¾‘

```javascript
// æŒ‰é¡ºåºå°è¯•è¿æ¥èŠ‚ç‚¹
for (let i = 0; i < this.apiNodes.length; i++) {
  const connected = await this.connectToNode(i, privateKey);
  if (connected) {
    return true;
  }
}
```

## ç›¸å…³æ–‡ä»¶

- `server/models/Settings.js` - æ•°æ®åº“æ¨¡å‹
- `server/services/tronService.js` - èŠ‚ç‚¹ç®¡ç†é€»è¾‘
- `server/routes/wallet.js` - é…ç½® API
- `src/pages/WalletConfigPage.jsx` - é…ç½®ç•Œé¢

## æ›´æ–°æ—¥å¿—

### 2025-01-30
- âœ… æ·»åŠ å¤šèŠ‚ç‚¹é…ç½®æ”¯æŒ
- âœ… å®ç°è‡ªåŠ¨æ•…éšœåˆ‡æ¢
- âœ… æ”¯æŒ TronGridã€ZANã€TronScan
- âœ… æ·»åŠ èŠ‚ç‚¹çŠ¶æ€æ˜¾ç¤º
- âœ… å®Œå–„æ—¥å¿—è¾“å‡º

## å‚è€ƒé“¾æ¥

- [TronGrid å®˜ç½‘](https://www.trongrid.io/)
- [ZAN å®˜ç½‘](https://zan.top/cn)
- [TRON å¼€å‘æ–‡æ¡£](https://developers.tron.network/)
