# Telegram Bot 群发系统使用指南

## 🚀 快速开始

### 1. 访问群发管理
1. 登录管理后台
2. 进入"Telegram Bot 管理"
3. 点击"📢 群发消息"标签

### 2. 创建群发消息
点击"+ 创建群发"按钮，填写表单

## 📝 表单字段说明

### 基础信息

#### 群发标题
- 用于识别和管理群发
- 例如："系统维护通知"、"新功能发布"

#### 内容类型
- **📝 纯文本**：只发送文字消息
- **🖼️ 图片**：发送图片 + 说明文字
- **🎬 视频**：发送视频 + 说明文字
- **📄 文档**：发送文档 + 说明文字

#### 解析模式
- **HTML**：推荐，支持 `<b>` `<i>` `<code>` 等标签
- **Markdown**：支持 `**粗体**` `*斜体*` 等
- **MarkdownV2**：Markdown 增强版

### 媒体设置（非文本类型）

#### 媒体 URL
支持两种格式：
1. **HTTPS 链接**：`https://example.com/image.jpg`
2. **Telegram 文件 ID**：`AgACAgIAAxkBAAI...`

获取 Telegram 文件 ID：
1. 在 Bot 中发送图片/视频/文档
2. 查看日志获取 file_id
3. 复制使用

### 目标用户

#### 👥 所有用户
- 发送给所有注册用户
- 包括活跃和不活跃用户

#### ✅ 活跃用户（30天内）
- 只发送给最近 30 天有活动的用户
- 提高送达率

#### 💤 不活跃用户
- 发送给超过 30 天未活动的用户
- 用于唤醒用户

#### 👨‍👩‍👧‍👦 群组
- 发送到群组或频道
- 需要先将 Bot 添加到群组

### 群组选择

#### 自动检测的群组
- 显示所有 Bot 所在的群组
- 勾选要发送的群组
- 显示群组类型、Bot 状态、成员数

#### 手动输入 Chat ID
- 点击"或手动输入 Chat ID"展开
- 每行输入一个 Chat ID
- 格式：`-1001234567890`

获取 Chat ID：
1. 将 Bot 添加到群组
2. 在群组中发送消息
3. 刷新页面查看群组列表
4. 或使用 @userinfobot 获取

### 消息内容

#### 文本消息
- 输入完整的消息内容
- 支持 HTML 标签美化

#### 媒体消息
- 输入说明文字（可选）
- 说明文字会显示在媒体下方

### 按钮配置（可选）

#### 添加按钮
1. 点击"+ 添加按钮"
2. 输入按钮文字
3. 选择按钮类型
4. 输入按钮数据

#### 按钮类型
- **回调**：触发 Bot 功能，输入 callback_data
- **链接**：打开网页，输入完整 URL

## 🎨 HTML 标签参考

### 常用标签
```html
<b>粗体文字</b>
<i>斜体文字</i>
<code>代码文字</code>
<pre>预格式化文本</pre>
<a href="https://example.com">链接文字</a>
<u>下划线</u>
<s>删除线</s>
```

### 示例消息
```html
🎉 <b>系统更新通知</b>

📋 <b>更新内容：</b>
━━━━━━━━━━━━━━━
<code>1.</code> 新增闪兑功能
<code>2.</code> 优化支付流程
<code>3.</code> 修复已知问题
━━━━━━━━━━━━━━━

💡 <i>更多详情请访问官网</i>

<a href="https://kk.vpno.eu.org">立即体验</a>
```

## 📤 发送流程

### 1. 创建草稿
1. 填写完整表单
2. 点击"创建"按钮
3. 群发保存为草稿状态

### 2. 编辑草稿
1. 在列表中找到草稿
2. 点击"编辑"按钮
3. 修改后点击"更新"

### 3. 发送群发
1. 确认内容无误
2. 点击"发送"按钮
3. 确认发送

### 4. 查看进度
- 状态变为"发送中"
- 显示发送进度
- 完成后显示统计

## 📊 统计数据

### 发送统计
- **总数**：目标用户/群组数量
- **成功**：成功发送的数量
- **失败**：发送失败的数量

### 失败原因
- 用户屏蔽了 Bot（403）
- 无效的用户 ID（400）
- 网络错误或其他问题

## 🔧 高级功能

### 1. 定时发送（未来功能）
- 设置发送时间
- 自动在指定时间发送

### 2. 变量替换（未来功能）
- 使用 `{{username}}` 等变量
- 自动替换为用户信息

### 3. A/B 测试（未来功能）
- 创建多个版本
- 对比发送效果

## ⚠️ 注意事项

### 1. 发送限制
- Telegram 限制：每秒 30 条消息
- 系统自动控制发送速度
- 大量用户会分批发送

### 2. 用户屏蔽
- 被屏蔽的用户无法接收消息
- 系统会自动跳过
- 不影响其他用户

### 3. 群组权限
- Bot 需要发送消息权限
- 频道需要 Bot 为管理员
- 检查群组列表中的 Bot 状态

### 4. 媒体文件
- 确保 URL 可访问
- 文件大小不超过限制
- 图片：最大 10MB
- 视频：最大 50MB
- 文档：最大 50MB

### 5. 内容审核
- 遵守 Telegram 使用条款
- 不发送垃圾信息
- 不发送违法内容

## 🐛 常见问题

### Q1: 群组列表为空？
**A:** 
1. 确认 Bot 已添加到群组
2. 在群组中发送任意消息
3. 刷新页面

### Q2: 发送失败？
**A:**
1. 检查 Bot Token 是否正确
2. 检查网络连接
3. 查看错误日志

### Q3: 图片无法显示？
**A:**
1. 确认 URL 可访问
2. 使用 HTTPS 链接
3. 或使用 Telegram 文件 ID

### Q4: 用户收不到消息？
**A:**
1. 用户可能屏蔽了 Bot
2. 用户 ID 可能无效
3. 查看发送统计

### Q5: 触发限流？
**A:**
- 系统会自动处理
- 等待后自动重试
- 无需手动操作

## 💡 最佳实践

### 1. 内容优化
- 使用 emoji 增强视觉效果
- 使用 HTML 标签美化排版
- 保持消息简洁明了
- 添加按钮增强交互

### 2. 发送时机
- 避开用户休息时间
- 选择活跃时段发送
- 重要通知可发送多次

### 3. 测试发送
- 先发送给测试群组
- 确认格式正确
- 再发送给所有用户

### 4. 频率控制
- 不要频繁群发
- 每周不超过 2-3 次
- 避免打扰用户

### 5. 内容分类
- 使用标题区分类型
- 系统通知、活动推广、功能更新等
- 方便用户识别

## 📞 技术支持

遇到问题？
1. 查看错误日志
2. 检查配置文件
3. 联系技术支持

---

**祝您使用愉快！** 🎉
