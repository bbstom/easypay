# 通知模板配置说明

## 问题
用户在后台看不到新增的通知模板类型：
- `payment_success` - 支付成功通知
- `transfer_complete` - 代付完成通知  
- `transfer_failed` - 代付失败通知

## 原因
这些通知模板使用的是 **TelegramContent** 模型（内容管理），而不是 **TelegramTemplate** 模型（消息模板）。

## 解决方案

### 方法 1：在后台"内容管理"标签页创建（推荐）

1. 登录后台管理页面
2. 进入 **Telegram Bot 管理** → **内容管理** 标签页
3. 点击 **"+ 创建内容"** 按钮
4. 在"内容标识 (key)"下拉列表中选择对应的模板类型：
   - `payment_success` - 支付成功通知
   - `transfer_complete` - 代付完成通知
   - `transfer_failed` - 代付失败通知
5. 系统会自动加载默认模板，你可以根据需要修改
6. 点击"保存"

### 方法 2：使用默认模板（无需配置）

如果你不创建自定义模板，系统会自动使用代码中的默认消息。

## 可用变量

### payment_success（支付成功通知）
- `{{orderId}}` - 订单号
- `{{totalCNY}}` - 支付金额（人民币）
- `{{payType}}` - 支付类型（USDT/TRX）

### transfer_complete（代付完成通知）
- `{{orderId}}` - 订单号
- `{{amount}}` - 数量
- `{{payType}}` - 类型（USDT/TRX）
- `{{address}}` - 收款地址
- `{{txHash}}` - 交易哈希

### transfer_failed（代付失败通知）
- `{{orderId}}` - 订单号
- `{{amount}}` - 数量
- `{{payType}}` - 类型（USDT/TRX）
- `{{reason}}` - 失败原因

## 示例模板

### 支付成功通知
```
🎉 <b>支付成功！</b>

━━━━━━━━━━━━━━━
<code>订单号：</code><code>{{orderId}}</code>
<code>金  额：</code><b>{{totalCNY}} CNY</b>
━━━━━━━━━━━━━━━

⏳ 正在处理 <b>{{payType}} 代付</b>...
⏱️ 预计 <b>2-10 分钟</b>完成

💬 完成后会自动通知您
⚠️ 请勿关闭此页面
```

### 代付完成通知
```
✅ <b>代付完成！</b>

━━━━━━━━━━━━━━━
<code>订单号：</code><code>{{orderId}}</code>
<code>数  量：</code><b>{{amount}} {{payType}}</b>
<code>地  址：</code><code>{{address}}</code>
━━━━━━━━━━━━━━━

🔗 <b>交易哈希</b>
<code>{{txHash}}</code>

🔍 点击下方按钮查看交易详情
```

### 代付失败通知
```
❌ <b>代付失败</b>

━━━━━━━━━━━━━━━
<code>订单号：</code><code>{{orderId}}</code>
<code>数  量：</code>{{amount}} {{payType}}
━━━━━━━━━━━━━━━

<b>失败原因：</b>
<i>{{reason}}</i>

💬 请联系客服处理
```

## 注意事项

1. **模板类型选择**：在"内容管理"标签页创建内容时，"内容标识 (key)"必须使用正确的值（如 `payment_success`）
2. **启用状态**：创建后确保模板的"启用"开关是打开的
3. **变量替换**：使用 `{{变量名}}` 格式，系统会自动替换为实际值
4. **HTML 标签**：支持 `<b>`、`<code>`、`<i>` 等 HTML 标签
5. **按钮配置**：可以添加自定义按钮，如"查看订单"、"联系客服"等

## 测试方法

1. 创建一个测试订单
2. 完成支付
3. 观察 Telegram Bot 发送的通知消息
4. 如果使用了自定义模板，消息会按照你的配置显示
5. 如果没有自定义模板，会显示默认消息

## 更新说明

已更新 `src/pages/TelegramManagePage.jsx`，在"消息模板"标签页的模板类型下拉列表中也添加了这些选项，但请注意：
- **"消息模板"标签页**：用于旧的模板系统（TelegramTemplate 模型）
- **"内容管理"标签页**：用于新的内容系统（TelegramContent 模型）✅ 推荐使用

通知系统使用的是"内容管理"系统，所以请在"内容管理"标签页创建这些模板。
