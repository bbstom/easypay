# 🚀 加密货币自动转账 - 快速开始

## 5分钟快速配置

### 步骤 1: 准备 TRON 钱包

#### 选项 A: 使用现有钱包
如果您已有 TRON 钱包，导出私钥即可。

#### 选项 B: 创建新钱包
1. 访问 [TronLink](https://www.tronlink.org/) 或 [TronScan](https://tronscan.org/)
2. 创建新钱包
3. **备份助记词和私钥**（非常重要！）
4. 获取钱包地址

### 步骤 2: 充值钱包

#### 充值 TRX（用于手续费）
- 最少: 50 TRX
- 建议: 100+ TRX
- 用途: 支付转账手续费

#### 充值 USDT（如果提供 USDT 代付）
- 根据业务量准备
- 建议: 1000+ USDT

💡 **提示**: 可以在交易所购买后提现到钱包地址

### 步骤 3: 配置系统

#### 3.1 添加私钥到 .env 文件

```bash
# 编辑 .env 文件
TRON_PRIVATE_KEY=你的64位私钥（不要加0x前缀）
```

⚠️ **安全提示**: 
- 不要将 .env 文件提交到 Git
- 不要分享私钥给任何人
- 定期备份私钥

#### 3.2 在管理后台配置

1. 登录管理后台
2. 进入 **系统设置 → TRON配置**
3. 填写以下信息：
   - **TRON API URL**: `https://api.trongrid.io`
   - **TRON Private Key**: 您的私钥
4. 点击保存

### 步骤 4: 测试钱包连接

```bash
npm run test-wallet
```

**预期输出**:
```
✅ 数据库连接成功
✅ TronWeb 初始化成功
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📍 钱包地址: TXxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
💰 TRX 余额: 100.000000 TRX
💵 USDT 余额: 1000.000000 USDT
✅ 状态: 就绪
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 步骤 5: 测试小额转账（可选）

```bash
npm run test-transfer
```

按提示操作：
1. 选择币种（USDT 或 TRX）
2. 输入接收地址
3. 输入金额（建议先测试小额，如 1 USDT）
4. 确认转账
5. 查看交易结果

### 步骤 6: 启动系统

```bash
npm run dev
```

系统现在已经可以自动处理转账了！

## 📊 监控和管理

### 查看钱包状态

1. 登录管理后台
2. 进入 **财务管理**
3. 查看顶部的"钱包状态"卡片

显示内容：
- 钱包地址
- TRX 余额
- USDT 余额
- 余额预警（如有）

### 处理失败订单

如果有转账失败的订单：
1. 在财务管理页面找到失败订单
2. 点击"重试"按钮
3. 系统会自动重新执行转账

### 查看转账记录

1. 在订单列表中找到订单
2. 点击交易哈希链接
3. 在 TRONSCAN 查看详细信息

## 🔍 常见问题

### Q: 如何获取私钥？

**TronLink 钱包**:
1. 打开 TronLink
2. 点击设置 → 导出私钥
3. 输入密码
4. 复制私钥

**其他钱包**: 查看对应钱包的导出功能

### Q: 测试网如何使用？

1. 修改 TRON API URL 为测试网地址：
   - Nile: `https://nile.trongrid.io`
   - Shasta: `https://api.shasta.trongrid.io`

2. 获取测试币：
   - 访问 [Nile 水龙头](https://nileex.io/join/getJoinPage)
   - 输入钱包地址
   - 领取测试 TRX 和 USDT

### Q: 手续费太高怎么办？

**方案 1: 质押 TRX 获取能量**
- 质押 1000 TRX 可获得约 32000 能量
- 一笔 USDT 转账约需 31895 能量
- 有能量时手续费接近 0

**方案 2: 租赁能量**
- 使用能量租赁服务
- 成本比直接支付 TRX 更低

### Q: 转账失败怎么办？

1. 检查钱包余额是否充足
2. 运行 `npm run test-wallet` 检查状态
3. 查看服务器日志获取详细错误
4. 使用管理后台的"重试"功能

### Q: 如何确认转账成功？

1. 查看订单的"转账状态"是否为"已完成"
2. 点击交易哈希在 TRONSCAN 查看
3. 检查接收地址的余额

## 🎯 最佳实践

### 1. 余额管理

- 每天检查钱包余额
- TRX 低于 50 时及时充值
- USDT 根据订单量提前准备

### 2. 安全管理

- 使用专用钱包，不要与个人资产混用
- 定期备份私钥
- 不要在公共场合展示私钥
- 定期更换钱包（可选）

### 3. 监控告警

- 关注财务管理页面的余额预警
- 定期查看失败订单
- 记录异常情况

### 4. 测试流程

- 新功能上线前先在测试网测试
- 主网先用小额测试
- 确认无误后再处理大额订单

## 📞 需要帮助？

如果遇到问题：

1. 查看服务器日志
2. 运行测试脚本诊断
3. 检查配置是否正确
4. 查看 CRYPTO_TRANSFER_IMPLEMENTATION.md 详细文档

## ✅ 检查清单

配置完成后，确认以下项目：

- [ ] TRON 钱包已创建
- [ ] 私钥已添加到 .env
- [ ] 钱包已充值（TRX + USDT）
- [ ] 管理后台已配置
- [ ] 测试钱包连接成功
- [ ] 测试转账成功（可选）
- [ ] 系统已启动
- [ ] 财务管理页面可以看到钱包状态

全部完成后，您的系统就可以自动处理加密货币转账了！🎉

---

**下一步**: 创建测试订单，体验完整的支付和转账流程。
