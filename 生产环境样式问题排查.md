# ç”Ÿäº§ç¯å¢ƒæ ·å¼é—®é¢˜æ’æŸ¥æŒ‡å—

## é—®é¢˜ç°è±¡

- âœ… å¼€å‘ç¯å¢ƒï¼ˆlocalhost:3000ï¼‰æ ·å¼æ­£å¸¸
- âŒ ç”Ÿäº§ç¯å¢ƒæ ·å¼ä¸ç”Ÿæ•ˆï¼Œæ²¡æœ‰å±‚æ¬¡æ„Ÿ

## åŸå› åˆ†æ

ç”Ÿäº§ç¯å¢ƒä½¿ç”¨çš„æ˜¯æ„å»ºåçš„é™æ€æ–‡ä»¶ï¼Œå¯èƒ½çš„åŸå› ï¼š

1. **æ„å»ºæ—¶æ²¡æœ‰åŒ…å«æ–°çš„ Tailwind é…ç½®**
2. **æµè§ˆå™¨ç¼“å­˜äº†æ—§çš„ CSS æ–‡ä»¶**
3. **CDN/Nginx ç¼“å­˜äº†æ—§æ–‡ä»¶**
4. **æ„å»ºäº§ç‰©æ²¡æœ‰æ›´æ–°**

---

## æ’æŸ¥æ­¥éª¤

### æ­¥éª¤ 1ï¼šæ£€æŸ¥æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶

SSH ç™»å½•æœåŠ¡å™¨ï¼Œæ£€æŸ¥å…³é”®æ–‡ä»¶ï¼š

```bash
# ç™»å½•æœåŠ¡å™¨
ssh root@your-server

# è¿›å…¥é¡¹ç›®ç›®å½•
cd /www/wwwroot/kk.vpno.eu.org/easypay

# æ£€æŸ¥ tailwind.config.js æ˜¯å¦åŒ…å« typography æ’ä»¶
cat tailwind.config.js | grep typography

# åº”è¯¥çœ‹åˆ°ï¼š
# require('@tailwindcss/typography'),
```

### æ­¥éª¤ 2ï¼šæ£€æŸ¥ä¾èµ–æ˜¯å¦å®‰è£…

```bash
# æ£€æŸ¥ typography æ’ä»¶æ˜¯å¦å®‰è£…
npm list @tailwindcss/typography

# åº”è¯¥æ˜¾ç¤ºï¼š
# â””â”€â”€ @tailwindcss/typography@0.5.19

# å¦‚æœæ²¡æœ‰ï¼Œæ‰‹åŠ¨å®‰è£…
npm install @tailwindcss/typography
```

### æ­¥éª¤ 3ï¼šæ£€æŸ¥ package.json

```bash
# æŸ¥çœ‹ package.json ä¸­æ˜¯å¦åŒ…å« typography
cat package.json | grep typography

# åº”è¯¥çœ‹åˆ°ï¼š
# "@tailwindcss/typography": "^0.5.19",
```

### æ­¥éª¤ 4ï¼šæ¸…é™¤æ—§çš„æ„å»ºäº§ç‰©

```bash
# åˆ é™¤æ—§çš„æ„å»ºæ–‡ä»¶
rm -rf dist
rm -rf node_modules/.vite

# å¦‚æœä½¿ç”¨ Windows æœåŠ¡å™¨
rmdir /s /q dist
rmdir /s /q node_modules\.vite
```

### æ­¥éª¤ 5ï¼šé‡æ–°å®‰è£…ä¾èµ–ï¼ˆå¯é€‰ï¼‰

```bash
# å¦‚æœæ€€ç–‘ä¾èµ–æœ‰é—®é¢˜ï¼Œé‡æ–°å®‰è£…
rm -rf node_modules
npm install
```

### æ­¥éª¤ 6ï¼šé‡æ–°æ„å»º

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# æ£€æŸ¥æ„å»ºæ˜¯å¦æˆåŠŸ
ls -lh dist/

# åº”è¯¥çœ‹åˆ°æ–°çš„æ–‡ä»¶ï¼Œæ—¶é—´æˆ³æ˜¯æœ€æ–°çš„
```

### æ­¥éª¤ 7ï¼šé‡å¯æœåŠ¡

```bash
# å¦‚æœä½¿ç”¨ PM2
pm2 restart all

# æˆ–è€…é‡å¯ç‰¹å®šåº”ç”¨
pm2 restart ecosystem.config.js

# æŸ¥çœ‹æ—¥å¿—
pm2 logs
```

### æ­¥éª¤ 8ï¼šæ¸…é™¤æµè§ˆå™¨ç¼“å­˜

åœ¨æµè§ˆå™¨ä¸­ï¼š
- Chrome/Edge: `Ctrl + Shift + Delete` â†’ æ¸…é™¤ç¼“å­˜
- æˆ–è€…ç¡¬åˆ·æ–°: `Ctrl + Shift + R`

### æ­¥éª¤ 9ï¼šæ£€æŸ¥ CSS æ–‡ä»¶

åœ¨æµè§ˆå™¨ä¸­ï¼š
1. æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ° Network æ ‡ç­¾
3. åˆ·æ–°é¡µé¢
4. æ‰¾åˆ° CSS æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ `index-xxx.css`ï¼‰
5. ç‚¹å‡»æŸ¥çœ‹å†…å®¹
6. æœç´¢ `prose` å…³é”®å­—

**åº”è¯¥çœ‹åˆ°**ï¼š
```css
.prose {
  color: var(--tw-prose-body);
  max-width: 65ch;
}

.prose-lg {
  font-size: 1.125rem;
  line-height: 1.7777778;
}

.prose-h2\:text-3xl h2 {
  font-size: 1.875rem;
}
```

**å¦‚æœæ²¡æœ‰çœ‹åˆ°**ï¼šè¯´æ˜æ„å»ºæ—¶æ²¡æœ‰åŒ…å« Typography æ ·å¼ã€‚

---

## å®Œæ•´ä¿®å¤æµç¨‹

### æ–¹æ¡ˆ 1ï¼šå¿«é€Ÿä¿®å¤ï¼ˆæ¨èï¼‰

```bash
# 1. ç™»å½•æœåŠ¡å™¨
ssh root@your-server
cd /www/wwwroot/kk.vpno.eu.org/easypay

# 2. æ‹‰å–æœ€æ–°ä»£ç ï¼ˆå¦‚æœä½¿ç”¨ Gitï¼‰
git pull origin main

# 3. å®‰è£…ä¾èµ–ï¼ˆç¡®ä¿ typography æ’ä»¶å®‰è£…ï¼‰
npm install

# 4. æ¸…é™¤æ—§æ„å»º
rm -rf dist node_modules/.vite

# 5. é‡æ–°æ„å»º
npm run build

# 6. é‡å¯æœåŠ¡
pm2 restart all

# 7. æŸ¥çœ‹æ—¥å¿—ç¡®è®¤æ— é”™è¯¯
pm2 logs --lines 50
```

### æ–¹æ¡ˆ 2ï¼šå®Œå…¨é‡å»º

```bash
# 1. å¤‡ä»½æ•°æ®åº“å’Œ .env æ–‡ä»¶
cp .env .env.backup

# 2. åˆ é™¤ node_modules
rm -rf node_modules

# 3. æ¸…é™¤ npm ç¼“å­˜
npm cache clean --force

# 4. é‡æ–°å®‰è£…æ‰€æœ‰ä¾èµ–
npm install

# 5. éªŒè¯ typography æ’ä»¶
npm list @tailwindcss/typography

# 6. æ¸…é™¤æ„å»ºç¼“å­˜
rm -rf dist node_modules/.vite

# 7. é‡æ–°æ„å»º
npm run build

# 8. é‡å¯æœåŠ¡
pm2 restart all
```

---

## éªŒè¯ä¿®å¤

### 1. æ£€æŸ¥æ„å»ºäº§ç‰©

```bash
# æŸ¥çœ‹ dist ç›®å½•
ls -lh dist/assets/

# åº”è¯¥çœ‹åˆ°æ–°çš„ CSS æ–‡ä»¶ï¼Œæ–‡ä»¶åç±»ä¼¼ï¼š
# index-abc123.css
```

### 2. æ£€æŸ¥ CSS æ–‡ä»¶å¤§å°

```bash
# æŸ¥çœ‹ CSS æ–‡ä»¶å¤§å°
du -h dist/assets/*.css

# Typography æ’ä»¶ä¼šå¢åŠ  CSS æ–‡ä»¶å¤§å°
# åº”è¯¥æ¯”ä¹‹å‰å¤§ 20-50KB
```

### 3. åœ¨æµè§ˆå™¨ä¸­éªŒè¯

è®¿é—®ï¼š`https://kk.vpno.eu.org/blog/usdt-ä»£ä»˜å®Œå…¨æŒ‡å—-ä»å…¥é—¨åˆ°ç²¾é€š`

æ£€æŸ¥ï¼š
- [ ] H2 æ ‡é¢˜æœ‰åº•éƒ¨è¾¹æ¡†
- [ ] H2ã€H3ã€H4 å¤§å°é€’å‡
- [ ] æ®µè½ä¹‹é—´æœ‰é—´è·
- [ ] åˆ—è¡¨æœ‰ç¼©è¿›å’Œç¬¦å·
- [ ] è¡¨æ ¼æœ‰è¾¹æ¡†å’ŒèƒŒæ™¯è‰²
- [ ] ä»£ç å—æœ‰æ·±è‰²èƒŒæ™¯

### 4. ä½¿ç”¨å¼€å‘è€…å·¥å…·æ£€æŸ¥

æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼š

```javascript
// åœ¨ Console ä¸­æ‰§è¡Œ
document.querySelector('.prose')

// åº”è¯¥è¿”å›å…ƒç´ ï¼Œè€Œä¸æ˜¯ null
```

æŸ¥çœ‹å…ƒç´ çš„è®¡ç®—æ ·å¼ï¼š
```javascript
// æ£€æŸ¥ H2 æ ‡é¢˜æ ·å¼
const h2 = document.querySelector('.prose h2');
console.log(window.getComputedStyle(h2).fontSize);
// åº”è¯¥æ˜¾ç¤º: "30px" æˆ– "1.875rem"

console.log(window.getComputedStyle(h2).borderBottom);
// åº”è¯¥æ˜¾ç¤º: "2px solid rgb(226, 232, 240)"
```

---

## å¸¸è§é—®é¢˜

### Q1: æ„å»ºæˆåŠŸä½†æ ·å¼è¿˜æ˜¯ä¸ç”Ÿæ•ˆ

**åŸå› **ï¼šæµè§ˆå™¨æˆ– CDN ç¼“å­˜

**è§£å†³**ï¼š
```bash
# 1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼ˆCtrl + Shift + Deleteï¼‰
# 2. ç¡¬åˆ·æ–°ï¼ˆCtrl + Shift + Rï¼‰
# 3. æˆ–è€…åœ¨ URL ååŠ æ—¶é—´æˆ³
https://kk.vpno.eu.org/blog/xxx?t=1234567890
```

### Q2: CSS æ–‡ä»¶ä¸­æ²¡æœ‰ prose æ ·å¼

**åŸå› **ï¼šTailwind é…ç½®æ²¡æœ‰ç”Ÿæ•ˆ

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥ tailwind.config.js
cat tailwind.config.js

# ç¡®ä¿åŒ…å«ï¼š
# plugins: [
#   require('@tailwindcss/typography'),
# ],

# å¦‚æœæ²¡æœ‰ï¼Œæ‰‹åŠ¨æ·»åŠ åé‡æ–°æ„å»º
npm run build
```

### Q3: æ„å»ºæ—¶æŠ¥é”™

**é”™è¯¯ç¤ºä¾‹**ï¼š
```
Error: Cannot find module '@tailwindcss/typography'
```

**è§£å†³**ï¼š
```bash
# å®‰è£…æ’ä»¶
npm install @tailwindcss/typography

# é‡æ–°æ„å»º
npm run build
```

### Q4: PM2 é‡å¯åè¿˜æ˜¯æ—§ç‰ˆæœ¬

**åŸå› **ï¼šPM2 å¯èƒ½ç¼“å­˜äº†æ—§çš„è¿›ç¨‹

**è§£å†³**ï¼š
```bash
# å®Œå…¨åœæ­¢å¹¶åˆ é™¤è¿›ç¨‹
pm2 delete all

# é‡æ–°å¯åŠ¨
pm2 start ecosystem.config.js

# æˆ–è€…
pm2 start npm --name "easypay" -- start
```

### Q5: Nginx ç¼“å­˜é—®é¢˜

**åŸå› **ï¼šNginx å¯èƒ½ç¼“å­˜äº†é™æ€æ–‡ä»¶

**è§£å†³**ï¼š
```bash
# æ¸…é™¤ Nginx ç¼“å­˜ï¼ˆå¦‚æœé…ç½®äº†ç¼“å­˜ï¼‰
rm -rf /var/cache/nginx/*

# é‡å¯ Nginx
systemctl restart nginx

# æˆ–è€…
nginx -s reload
```

---

## è°ƒè¯•å‘½ä»¤é›†åˆ

### æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æœ€æ–°

```bash
# æŸ¥çœ‹æ–‡ä»¶ä¿®æ”¹æ—¶é—´
stat tailwind.config.js
stat dist/index.html
stat dist/assets/*.css

# æŸ¥çœ‹æœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶
find . -name "*.css" -mtime -1 -ls
```

### æ£€æŸ¥è¿›ç¨‹çŠ¶æ€

```bash
# PM2 è¿›ç¨‹åˆ—è¡¨
pm2 list

# æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
pm2 show easypay

# æŸ¥çœ‹æ—¥å¿—
pm2 logs easypay --lines 100
```

### æ£€æŸ¥ç«¯å£å ç”¨

```bash
# æ£€æŸ¥ 3000 ç«¯å£
netstat -tulpn | grep 3000

# æˆ–è€…
lsof -i :3000
```

### æµ‹è¯•æ„å»ºäº§ç‰©

```bash
# åœ¨æœ¬åœ°æµ‹è¯•æ„å»ºäº§ç‰©
cd dist
python3 -m http.server 8080

# è®¿é—® http://localhost:8080
# æŸ¥çœ‹æ ·å¼æ˜¯å¦æ­£å¸¸
```

---

## é¢„é˜²æªæ–½

### 1. æ·»åŠ æ„å»ºéªŒè¯è„šæœ¬

åˆ›å»º `scripts/verify-build.js`ï¼š

```javascript
const fs = require('fs');
const path = require('path');

// æ£€æŸ¥ dist ç›®å½•æ˜¯å¦å­˜åœ¨
if (!fs.existsSync('dist')) {
  console.error('âŒ dist ç›®å½•ä¸å­˜åœ¨');
  process.exit(1);
}

// æ£€æŸ¥ CSS æ–‡ä»¶
const assetsDir = path.join('dist', 'assets');
const cssFiles = fs.readdirSync(assetsDir).filter(f => f.endsWith('.css'));

if (cssFiles.length === 0) {
  console.error('âŒ æ²¡æœ‰æ‰¾åˆ° CSS æ–‡ä»¶');
  process.exit(1);
}

// æ£€æŸ¥ CSS æ–‡ä»¶ä¸­æ˜¯å¦åŒ…å« prose æ ·å¼
const cssFile = path.join(assetsDir, cssFiles[0]);
const cssContent = fs.readFileSync(cssFile, 'utf8');

if (!cssContent.includes('.prose')) {
  console.error('âŒ CSS æ–‡ä»¶ä¸­æ²¡æœ‰ prose æ ·å¼');
  console.error('è¯·æ£€æŸ¥ Tailwind é…ç½®æ˜¯å¦æ­£ç¡®');
  process.exit(1);
}

console.log('âœ… æ„å»ºéªŒè¯é€šè¿‡');
console.log(`ğŸ“¦ CSS æ–‡ä»¶: ${cssFiles[0]}`);
console.log(`ğŸ“ æ–‡ä»¶å¤§å°: ${(fs.statSync(cssFile).size / 1024).toFixed(2)} KB`);
```

åœ¨ `package.json` ä¸­æ·»åŠ ï¼š

```json
{
  "scripts": {
    "build": "vite build",
    "postbuild": "node scripts/verify-build.js"
  }
}
```

### 2. æ·»åŠ éƒ¨ç½²è„šæœ¬

æ›´æ–° `deploy.sh`ï¼š

```bash
#!/bin/bash

echo "ğŸš€ å¼€å§‹éƒ¨ç½²..."

# 1. æ‹‰å–æœ€æ–°ä»£ç 
echo "ğŸ“¥ æ‹‰å–ä»£ç ..."
git pull origin main

# 2. å®‰è£…ä¾èµ–
echo "ğŸ“¦ å®‰è£…ä¾èµ–..."
npm install

# 3. æ¸…é™¤ç¼“å­˜
echo "ğŸ§¹ æ¸…é™¤ç¼“å­˜..."
rm -rf dist node_modules/.vite

# 4. æ„å»º
echo "ğŸ”¨ æ„å»ºé¡¹ç›®..."
npm run build

# 5. éªŒè¯æ„å»º
if [ ! -d "dist" ]; then
  echo "âŒ æ„å»ºå¤±è´¥ï¼šdist ç›®å½•ä¸å­˜åœ¨"
  exit 1
fi

# 6. é‡å¯æœåŠ¡
echo "ğŸ”„ é‡å¯æœåŠ¡..."
pm2 restart all

# 7. ç­‰å¾…æœåŠ¡å¯åŠ¨
sleep 3

# 8. æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 list

echo "âœ… éƒ¨ç½²å®Œæˆï¼"
echo "ğŸŒ è®¿é—®: https://kk.vpno.eu.org"
```

### 3. è®¾ç½®ç‰ˆæœ¬å·

åœ¨æ„å»ºæ—¶æ·»åŠ ç‰ˆæœ¬å·ï¼Œæ–¹ä¾¿è¿½è¸ªï¼š

```javascript
// vite.config.js
export default {
  define: {
    __BUILD_TIME__: JSON.stringify(new Date().toISOString()),
    __BUILD_VERSION__: JSON.stringify(process.env.npm_package_version)
  }
}
```

åœ¨é¡µé¢åº•éƒ¨æ˜¾ç¤ºï¼š

```jsx
<footer>
  <p>ç‰ˆæœ¬: {__BUILD_VERSION__}</p>
  <p>æ„å»ºæ—¶é—´: {__BUILD_TIME__}</p>
</footer>
```

---

## å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# å®Œæ•´éƒ¨ç½²æµç¨‹ï¼ˆä¸€é”®æ‰§è¡Œï¼‰
cd /www/wwwroot/kk.vpno.eu.org/easypay && \
git pull && \
npm install && \
rm -rf dist node_modules/.vite && \
npm run build && \
pm2 restart all && \
pm2 logs --lines 20

# å¿«é€Ÿé‡å»ºï¼ˆä¸æ‹‰å–ä»£ç ï¼‰
rm -rf dist node_modules/.vite && npm run build && pm2 restart all

# æ£€æŸ¥æ ·å¼æ˜¯å¦ç”Ÿæ•ˆ
curl -s https://kk.vpno.eu.org/assets/index-*.css | grep -o "\.prose" | head -5

# æŸ¥çœ‹æ„å»ºäº§ç‰©
ls -lh dist/assets/*.css
```

---

## æ€»ç»“

ç”Ÿäº§ç¯å¢ƒæ ·å¼é—®é¢˜é€šå¸¸æ˜¯ï¼š

1. **æ„å»ºé—®é¢˜** - é‡æ–°æ„å»ºè§£å†³
2. **ç¼“å­˜é—®é¢˜** - æ¸…é™¤ç¼“å­˜è§£å†³
3. **ä¾èµ–é—®é¢˜** - é‡æ–°å®‰è£…è§£å†³

**æœ€å¿«çš„è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
cd /www/wwwroot/kk.vpno.eu.org/easypay
rm -rf dist node_modules/.vite
npm run build
pm2 restart all
```

ç„¶ååœ¨æµè§ˆå™¨ä¸­ç¡¬åˆ·æ–°ï¼ˆCtrl + Shift + Rï¼‰ã€‚
