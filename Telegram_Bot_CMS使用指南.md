# Telegram Bot CMS 使用指南

## 快速开始

### 访问 CMS 系统

1. 登录管理后台
2. 进入 "Telegram Bot 管理" 页面
3. 点击 "📄 内容管理" 标签

## 界面说明

### 主界面布局

```
┌─────────────────────────────────────────────────────────┐
│  Telegram Bot 管理                                       │
├─────────────────────────────────────────────────────────┤
│  🎛️主菜单  📄内容管理  📝消息模板  📢群发  📊统计      │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  内容管理                          [+ 创建内容]          │
│                                                          │
│  [全部] [欢迎页面] [代付交互] [订单] [帮助] [自定义]    │
│                                                          │
│  ┌────────────────────────────────────────────────┐    │
│  │ 新用户欢迎消息                    [编辑] [删除] │    │
│  │ welcome | text                                  │    │
│  │ ─────────────────────────────────────────────  │    │
│  │ 🎊 欢迎使用 {{siteName}}！                     │    │
│  │ ✅ 账户已自动创建...                           │    │
│  │ ─────────────────────────────────────────────  │    │
│  │ 按钮: 0 个 | 变量: 4 个 | ✅ 支持复制 | 已启用  │    │
│  └────────────────────────────────────────────────┘    │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

## 创建内容

### 步骤 1: 基本信息

```
内容标识 (key): welcome_new_user
显示名称: 新用户欢迎消息
分类: [欢迎页面 ▼]
内容类型: [纯文本 ▼]
```

**注意：** 内容标识创建后不可修改，请谨慎填写！

### 步骤 2: 编辑内容

```
消息内容:                                    [HTML ▼]
┌──────────────────────────────────────────────────┐
│ 🎊 <b>欢迎使用 {{siteName}}！</b>              │
│                                                  │
│ ✅ <b>账户已自动创建</b>                        │
│ ━━━━━━━━━━━━━━━                                │
│ <code>用户名：</code>{{username}}              │
│ <code>TG ID：</code><code>{{telegramId}}</code>│
│                                                  │
│ 💡 <b>您可以直接开始使用所有功能！</b>         │
└──────────────────────────────────────────────────┘

HTML标签: [<b> 加粗] [<code> 代码] [<i> 斜体] [<a> 链接]
```

### 步骤 3: 配置变量

```
变量配置:                                  [+ 添加变量]
┌──────────────────────────────────────────────────────┐
│ siteName    │ 网站名称      │ FastPay    │ [插入] [删除] │
│ username    │ 用户名        │ user123    │ [插入] [删除] │
│ telegramId  │ Telegram ID   │ 123456789  │ [插入] [删除] │
│ websiteUrl  │ 网站地址      │ https://.. │ [插入] [删除] │
└──────────────────────────────────────────────────────┘
```

**提示：** 点击 "插入" 按钮可以快速将变量插入到内容中

### 步骤 4: 添加按钮（可选）

```
按钮配置:                                  [+ 添加按钮]
┌──────────────────────────────────────────────────────────┐
│ 查看订单 │ [回调 ▼] │ orders_list │ 行:0 │ 列:0 │ [删除] │
│ 访问网站 │ [链接 ▼] │ https://... │ 行:0 │ 列:1 │ [删除] │
│ 复制ID   │ [复制 ▼] │ {{telegramId}} │ 行:1 │ 列:0 │ [删除] │
└──────────────────────────────────────────────────────────┘
```

**按钮类型说明：**
- **回调**：触发 Bot 内部功能（callback_data）
- **链接**：打开外部网页（URL）
- **复制**：点击后复制文本到剪贴板

### 步骤 5: 功能特性

```
☑ 支持复制
  可复制的文本: {{telegramId}}
```

**提示：** 启用后，消息会显示复制按钮

### 步骤 6: 保存

点击 "保存" 按钮完成创建

## 编辑内容

1. 在内容列表中找到要编辑的内容
2. 点击 "编辑" 按钮
3. 修改内容
4. 点击 "保存"

**注意：** 内容标识（key）不可修改

## 删除内容

1. 在内容列表中找到要删除的内容
2. 点击 "删除" 按钮
3. 确认删除

**警告：** 删除操作不可恢复！

## 初始化默认内容

如果内容列表为空，可以点击 "初始化默认内容" 按钮快速创建预设内容：

- 新用户欢迎消息
- USDT 代付开始
- 更多预设内容...

## HTML 标签使用

### 常用标签

```html
<b>加粗文本</b>
<i>斜体文本</i>
<code>代码文本</code>
<a href="https://example.com">链接文本</a>
<pre>预格式化文本</pre>
<u>下划线文本</u>
<s>删除线文本</s>
```

### 示例

```html
🎊 <b>欢迎使用 {{siteName}}！</b>

✅ <b>账户已自动创建</b>
━━━━━━━━━━━━━━━
<code>用户名：</code>{{username}}
<code>TG ID：</code><code>{{telegramId}}</code>
━━━━━━━━━━━━━━━

💡 <b>您可以直接开始使用所有功能！</b>

🌐 <b>网站同步使用</b>
<code>1️⃣</code> 访问 <a href="{{websiteUrl}}">{{websiteUrl}}</a>
<code>2️⃣</code> 点击 "使用 Telegram 登录"
<code>3️⃣</code> 授权后即可同步使用

👇 请选择您需要的服务
```

## 变量系统

### 变量格式

```
{{variableName}}
```

### 常用变量

| 变量名 | 说明 | 示例 |
|--------|------|------|
| `{{siteName}}` | 网站名称 | FastPay |
| `{{username}}` | 用户名 | user123 |
| `{{telegramId}}` | Telegram ID | 123456789 |
| `{{websiteUrl}}` | 网站地址 | https://example.com |
| `{{orderId}}` | 订单ID | ORD20240205001 |
| `{{amount}}` | 金额 | 100 |
| `{{currency}}` | 币种 | USDT |
| `{{address}}` | 钱包地址 | TXxx...xxx |

### 自定义变量

1. 点击 "+ 添加变量"
2. 填写变量名（不含 `{{}}` ）
3. 填写说明和示例值
4. 点击 "插入" 将变量插入到内容中

## 按钮布局

### 行列说明

```
行:0, 列:0  |  行:0, 列:1  |  行:0, 列:2
─────────────────────────────────────────
行:1, 列:0  |  行:1, 列:1  |  行:1, 列:2
─────────────────────────────────────────
行:2, 列:0  |  行:2, 列:1  |  行:2, 列:2
```

### 示例布局

**单行多按钮：**
```
[按钮1 (0,0)] [按钮2 (0,1)] [按钮3 (0,2)]
```

**多行单按钮：**
```
[按钮1 (0,0)]
[按钮2 (1,0)]
[按钮3 (2,0)]
```

**混合布局：**
```
[按钮1 (0,0)] [按钮2 (0,1)]
[按钮3 (1,0)]
[按钮4 (2,0)] [按钮5 (2,1)] [按钮6 (2,2)]
```

## 内容类型

### 纯文本 (text)
- 只包含文本内容
- 支持 HTML 格式
- 最常用的类型

### 图片 (photo)
- 需要提供图片 URL
- 可以添加说明文字（caption）
- 支持按钮

### 视频 (video)
- 需要提供视频 URL
- 可以添加说明文字（caption）
- 支持按钮

### 文档 (document)
- 需要提供文档 URL
- 可以添加说明文字（caption）
- 支持按钮

## 分类说明

| 分类 | 用途 | 示例 |
|------|------|------|
| 欢迎页面 | 新用户欢迎、启动消息 | /start 命令响应 |
| 代付交互 | 代付流程中的消息 | 输入金额、确认订单 |
| 订单相关 | 订单状态通知 | 订单创建、完成、失败 |
| 帮助信息 | 帮助文档、FAQ | 使用说明、常见问题 |
| 自定义 | 其他自定义内容 | 活动通知、公告 |

## 实际应用示例

### 示例 1: 欢迎消息

**内容标识：** `welcome_new_user`
**分类：** 欢迎页面
**触发：** /start 命令

```html
🎊 <b>欢迎使用 {{siteName}}！</b>

✅ <b>账户已自动创建</b>
━━━━━━━━━━━━━━━
<code>用户名：</code>{{username}}
<code>TG ID：</code><code>{{telegramId}}</code>
━━━━━━━━━━━━━━━

💡 <b>您可以直接开始使用所有功能！</b>

👇 请选择您需要的服务
```

**变量：**
- siteName: 网站名称
- username: 用户名
- telegramId: Telegram ID

**功能：**
- ☑ 支持复制 telegramId

### 示例 2: USDT 代付开始

**内容标识：** `payment_usdt_start`
**分类：** 代付交互
**触发：** payment_usdt 回调

```html
💰 <b>USDT 代付</b>

📝 <b>请输入 USDT 数量</b>
━━━━━━━━━━━━━━━
<code>最小：</code>1 USDT
<code>最大：</code>{{maxAmount}} USDT
━━━━━━━━━━━━━━━

💡 直接输入数字即可
例如：<code>100</code>
```

**变量：**
- maxAmount: 最大金额

**按钮：**
- 取消 (callback: cancel_payment) - 行:0, 列:0

### 示例 3: 订单完成通知

**内容标识：** `order_completed`
**分类：** 订单相关
**触发：** 订单完成时

```html
✅ <b>订单已完成</b>

━━━━━━━━━━━━━━━
<code>订单号：</code><code>{{orderId}}</code>
<code>金额：</code>{{amount}} {{currency}}
<code>地址：</code><code>{{address}}</code>
<code>时间：</code>{{completedAt}}
━━━━━━━━━━━━━━━

💰 <b>代付已成功到账</b>

感谢您的使用！
```

**变量：**
- orderId: 订单ID
- amount: 金额
- currency: 币种
- address: 钱包地址
- completedAt: 完成时间

**按钮：**
- 查看详情 (callback: order_detail_{{orderId}}) - 行:0, 列:0
- 继续代付 (callback: payment_usdt) - 行:0, 列:1

**功能：**
- ☑ 支持复制 orderId
- ☑ 支持复制 address

## 最佳实践

### 1. 内容标识命名规范

```
分类_功能_状态

示例：
- welcome_new_user (欢迎_新用户)
- payment_usdt_start (代付_USDT_开始)
- payment_usdt_confirm (代付_USDT_确认)
- order_completed (订单_完成)
- order_failed (订单_失败)
```

### 2. 使用 Emoji 增强视觉效果

```
✅ 成功
❌ 失败
⚠️ 警告
💰 金钱
📝 输入
🎊 庆祝
💡 提示
👇 向下
🌐 网站
```

### 3. 使用分隔线

```
━━━━━━━━━━━━━━━
─────────────────
═════════════════
```

### 4. 代码块格式化

```html
<code>标签：</code>值
<code>金额：</code>100 USDT
<code>地址：</code><code>TXxx...xxx</code>
```

### 5. 按钮文字简洁明了

```
✅ 好的：确认、取消、查看详情
❌ 不好的：点击这里确认订单、取消当前操作
```

## 常见问题

### Q: 变量没有被替换？
A: 检查变量名是否正确，确保使用 `{{variableName}}` 格式

### Q: HTML 标签没有生效？
A: 确保选择了 "HTML" 解析模式

### Q: 按钮没有显示？
A: 检查按钮配置是否正确，确保填写了按钮文字和数据

### Q: 复制功能不工作？
A: 确保启用了 "支持复制" 选项，并填写了可复制的文本

### Q: 如何测试内容效果？
A: 可以使用预览功能，或直接在 Bot 中触发相应的功能

## 技术支持

如有问题，请查看：
- `Telegram_Bot_CMS系统完成.md` - 完整技术文档
- `Telegram_Bot_富文本内容管理系统.md` - 系统设计文档
- `server/bot/services/contentService.js` - 内容服务实现

---

**祝您使用愉快！** 🎉
