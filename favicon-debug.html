<!DOCTYPE html>
<html>
<head>
  <title>Favicon 调试页面</title>
</head>
<body>
  <h1>Favicon 调试</h1>
  <div id="result"></div>
  
  <script>
    // 测试 API 是否返回 siteFavicon
    fetch('/api/settings/public')
      .then(res => res.json())
      .then(data => {
        const resultDiv = document.getElementById('result');
        resultDiv.innerHTML = `
          <h2>API 返回结果：</h2>
          <pre>${JSON.stringify(data, null, 2)}</pre>
          <h3>siteFavicon 值：</h3>
          <p><strong>${data.siteFavicon || '未配置'}</strong></p>
          
          <h3>测试动态添加 Favicon：</h3>
          <button onclick="testAddFavicon()">点击添加 Favicon</button>
          <div id="test-result"></div>
        `;
      })
      .catch(err => {
        document.getElementById('result').innerHTML = `
          <h2>错误：</h2>
          <pre>${err.message}</pre>
        `;
      });
    
    function testAddFavicon() {
      const testResult = document.getElementById('test-result');
      
      // 移除现有的 favicon
      const existingFavicons = document.querySelectorAll('link[rel*="icon"]');
      testResult.innerHTML += `<p>移除了 ${existingFavicons.length} 个现有 favicon</p>`;
      existingFavicons.forEach(link => link.remove());
      
      // 添加新的 favicon
      const link = document.createElement('link');
      link.rel = 'icon';
      link.href = '/icons/usdt.svg';
      document.head.appendChild(link);
      
      testResult.innerHTML += `<p>✅ 已添加: &lt;link rel="icon" href="/icons/usdt.svg"&gt;</p>`;
      
      // 添加 apple-touch-icon
      const appleLink = document.createElement('link');
      appleLink.rel = 'apple-touch-icon';
      appleLink.href = '/icons/usdt.svg';
      document.head.appendChild(appleLink);
      
      testResult.innerHTML += `<p>✅ 已添加: &lt;link rel="apple-touch-icon" href="/icons/usdt.svg"&gt;</p>`;
      testResult.innerHTML += `<p><strong>请打开 F12 → Elements → 查看 &lt;head&gt; 标签</strong></p>`;
    }
  </script>
</body>
</html>
