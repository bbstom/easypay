# 闪兑系统 - 快速配置指南

## 🚀 5分钟快速配置

### 步骤 1: 添加闪兑钱包

1. 登录管理后台
2. 点击左侧菜单 **"闪兑系统"** → **"闪兑钱包"**
3. 点击 **"+ 添加钱包"** 按钮
4. 填写信息：
   - **钱包名称**: 例如 "闪兑主钱包"
   - **私钥**: 输入TRON钱包私钥（64位十六进制）
   - **优先级**: 设置为 90（数值越大优先级越高）
5. 点击 **"添加钱包"**

> ⚠️ **重要**：确保该钱包有足够的 TRX 余额用于闪兑！

### 步骤 2: 配置汇率

1. 点击 **"闪兑系统"** → **"汇率设置"**
2. 选择 **"实时汇率（推荐 - 从Binance获取）"**
3. 设置 **"闪兑汇率加成"**: 例如 `2`（表示用户换到的TRX减少2%）
4. 点击 **"刷新汇率"** 查看当前市场价格
5. 点击右上角 **"保存设置"**

### 步骤 3: 设置限额

1. 点击 **"闪兑系统"** → **"限额配置"**
2. 确保 **"启用闪兑功能"** 开关已打开
3. 设置限额：
   - **最小兑换金额**: `10` USDT
   - **最大兑换金额**: `10000` USDT
   - **订单超时时间**: `30` 分钟
4. 点击右上角 **"保存设置"**

### 步骤 4: 测试闪兑

1. 访问用户端闪兑页面（通常是 `/swap`）
2. 输入兑换金额（例如 10 USDT）
3. 输入接收地址（T开头的TRON地址）
4. 点击 **"创建兑换订单"**
5. 按照提示转账 USDT
6. 等待系统自动发送 TRX

---

## 📊 汇率说明

### 实时模式（推荐）

```
基础汇率: 从 Binance 获取 TRX/USDT 交易对价格
例如: 1 USDT = 6.7 TRX

加成: 2%
用户实际得到: 6.7 × (1 - 0.02) = 6.566 TRX
```

### 手动模式

```
管理员设置: 1 USDT = 6.5 TRX
加成: 2%
用户实际得到: 6.5 × (1 - 0.02) = 6.37 TRX
```

---

## 💡 工作原理

```
用户操作:
1. 用户创建订单: 100 USDT → 656.6 TRX
2. 系统分配钱包: 闪兑主钱包 (TXxx...xxx)
3. 用户转账: 100 USDT → TXxx...xxx

系统处理:
4. 监控服务检测到转账
5. 验证金额匹配
6. 从 TXxx...xxx 发送 656.6 TRX 到用户地址
7. 订单完成
```

---

## ⚠️ 常见问题

### Q1: 为什么需要专用钱包？

**A**: 闪兑钱包用于接收用户的 USDT 并发送 TRX。用户转 USDT 到哪个钱包，TRX 就从那个钱包返回，确保资金流向清晰。

### Q2: 可以配置多个钱包吗？

**A**: 可以！系统会按优先级自动选择。建议配置2-3个钱包作为备用。

### Q3: 钱包需要多少余额？

**A**: 
- **TRX**: 根据业务量，建议至少 10,000 TRX
- **USDT**: 会不断收到用户转入的 USDT
- **能量/带宽**: 确保足够的资源用于转账

### Q4: 汇率多久更新一次？

**A**: 
- **实时模式**: 每次用户创建订单时实时获取
- **手动模式**: 管理员手动更新

### Q5: 订单超时怎么办？

**A**: 超时订单会自动取消，用户需要重新创建订单。建议设置30分钟超时。

---

## 🔧 高级配置

### 多钱包策略

```
钱包1: 优先级 90 (主钱包)
钱包2: 优先级 80 (备用钱包)
钱包3: 优先级 70 (应急钱包)

系统会优先使用钱包1，如果钱包1禁用或余额不足，
自动切换到钱包2，以此类推。
```

### 汇率加成策略

```
保守策略: 加成 1-2%
平衡策略: 加成 2-3%
激进策略: 加成 3-5%

加成越高，平台利润越大，但用户换到的TRX越少。
建议根据市场竞争情况调整。
```

---

## 📞 技术支持

如果遇到问题：

1. 检查闪兑钱包是否启用
2. 检查钱包余额是否充足
3. 检查API节点是否正常
4. 查看服务器日志排查问题

---

**配置完成后，闪兑系统即可正常使用！** 🎉
